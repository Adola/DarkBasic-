Rem Project: Engine
Rem Created: 11/11/2009 5:56:49 PM

Rem ***** Main Source File *****
Sync On
Sync Rate 30
hide mouse
autocam off
backdrop on
set camera range 1,5000
fog on
fog distance 4000
fog color RGB(142,35,24)
color backdrop RGB(226,98,84)
rem make matrix.
make matrix 1,10000,10000,20,20
   REM load textures
load image "apple.jpg",1
load image "ugly.jpg",2
load image "grass.jpg",3
prepare matrix texture 1,3,1,1
fill matrix 1,0,1
randomize matrix 1,250
update matrix 1
load object "AST_01.X",100
position object 100,200,100,200
loop object 100
For x = 1 to 5
   make object cube x,80
   position object x,(x*100),35,2000
   set object collision to boxes x
   texture object x,2
next x
make object sphere 10,100
position object 10, 100,0,100

set object collision to spheres 10
texture object 10,1
rem Make Gun
Make object cylinder 101,10
XRotate Object 101,90
Fix object pivot 101
Scale object 101,50,1000,50
position object 101,10,-7,30
Lock object on 101
Rem Make bullet
Make Object Sphere 102,2
Hide Object 102




rem Start engine
Do
   set cursor 0,0
   print screen fps()
   OldCamAngleY# = CameraAngleY#
   OldCamAngleX# = CameraAngleX#
   CameraAngleY# = WrapValue(CameraAngleY#+MousemoveX()*0.2)
   CameraAngleX# = WrapValue(CameraAngleX#+MousemoveY()*0.2)

   Rem  Control input for camera
rem forward
   If Keystate(17) = 1
      XTest# = Newxvalue(X#,CameraAngleY#,10)
      ZTest# = Newzvalue(Z#,CameraAngleY#,10)
      If XTest#>0 and XTest#<10000 and ZTest#>0 and ZTest#<10000
         X#=XTest#
         Z#=ZTest#
      Endif
   Endif
rem back
   if Keystate(31) = 1
      XTest# = Newxvalue(X#,Wrapvalue(CameraAngleY#-180),10)
      ZTest# = Newzvalue(Z#,Wrapvalue(CameraAngleY#-180),10)
      If XTest#>0 and XTest#<10000 and ZTest#>0 and ZTest#<10000
         X#=XTest#
         Z#=ZTest#
      Endif
   Endif
rem left
if Keystate(30) = 1
   XTest# = Newxvalue(X#,Wrapvalue(CameraAngleY#-90),10)
   ZTest# = Newzvalue(Z#,Wrapvalue(CameraAngleY#-90),10)
   If XTest#>0 and XTest#<10000 and ZTest#>0 and ZTest#<10000
      X#=XTest#
      Z#=ZTest#
   Endif
Endif
rem right
If Keystate(32) = 1
   XTest# = Newxvalue(X#,Wrapvalue(CameraAngleY#+90),10)
   ZTest# = Newzvalue(Z#,Wrapvalue(CameraAngleY#+90),10)
   If XTest#>0 and XTest#<10000 and ZTest#>0 and ZTest#<10000
      X#=XTest#
      Z#=ZTest#
   Endif
Endif
   Yrotate camera CurveAngle(CameraAngleY#,OldCamAngleY#,24)
   Xrotate camera CurveAngle(CameraAngleX#,OldCamAngleX#,24)

   Y# = Get ground height(1,X#,Z#)
   Position Camera X#,Y#+50,Z#
rem This is what makes the bullet shoot.
rem mouseclick()=1 right, 2, left mouse.
   if Mouseclick()=1 and BulletLife=0
   Position object 102,X#+40,Y#+43,Z#
   Set object to camera orientation 102
   BulletLife =25
   Show object 102
Endif
If BulletLife > 0
   Dec BulletLife
   Move object 102,20
   If BulletLife = 0 then Hide object 102
Endif



   REMSTART this is for 3rd Person. +++++++++++++++++++++++++++++++++++++++++++++++++++++
   AngleY# = object angle Y(10)
    Rem Control input for camera
   If Upkey()=1
      XTest# = Newxvalue(X#,AngleY#,20)
      ZTest# = Newzvalue(Z#,AngleY#,20)
      If XTest#>0 and XTest#<10000 and ZTest#>0 and ZTest#<10000
         Move object 10,10
      Endif
   Endif

   If Leftkey()=1 then Yrotate object 10,Wrapvalue(AngleY#-5)
   If Rightkey()=1 then Yrotate object 10,Wrapvalue(AngleY#+5)
If Object collision(10,0)>0 then position object 10,X#,Y#,Z#
   X# = Object position x(10)
   Z# = Object position z(10)
   Y# = Get Ground Height(1,X#,Z#)
   Position object 10,X#,Y#+42.5,Z#
   CameraZ# = Newzvalue(Z#,AngleX#+180,200)
   CameraX# = Newxvalue(X#,AngleY#-180,100)
   CameraY# = Get Ground Height(1,CameraX#,CameraZ#)
   Position camera CameraX#+100,CameraY#+150,CameraZ#
   Point camera X#,Y#+25,Z#
   rem+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   REMEND

   scroll object texture 3,0.998,0.998
   Scroll object texture 2,0,0.005
   Scale object texture 3,0.998,0.998
   Scale object texture 4,1.001,1.001
   Sync
Loop
